
@page "/components/calendar-more"
@using RizzyUI
@using RizzyUI.Docs
@using Blazicons
@inherits RzComponent

<PageTitle>Calendar Examples</PageTitle>

<RzQuickReferenceContainer>
    <RzArticle ProseWidth="ProseWidth.UltraWide">
        <SideContent>
            <RzQuickReference />
        </SideContent>
        <MainContent>
            <RzHeading Level="HeadingLevel.H1" QuickReferenceTitle="All Calendar Examples" class="scroll-mt-20">All Calendar Examples</RzHeading>
            <RzParagraph>
                Advanced examples demonstrating the <code>RzCalendarProvider</code> for client-side orchestration. 
                These examples use <strong>Alpine.js</strong> state management to create interactive UIs without server round-trips.
            </RzParagraph>

            <!-- 1. Basic Selection with Provider Feedback -->
            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Client-Side Feedback" class="scroll-mt-20">Client-Side Feedback</RzHeading>
                <RzParagraph>
                    Use <code>RzCalendarProvider</code> to display the selected date reactively. The text updates instantly as you click.
                </RzParagraph>

                <div class="grid gap-6 xl:grid-cols-2">
                    <RzCard>
                        <CardHeader><CardTitle>Single Date</CardTitle></CardHeader>
                        <CardContent class="flex flex-col items-center gap-4">
                            <RzCalendarProvider Mode="SelectionDatesMode.Single" Value="_date1">
                                <div class="rounded-md border p-1">
                                    <RzCalendar />
                                </div>
                                <p class="text-sm text-muted-foreground">
                                    Selected: <span x-text="date || 'None'" class="font-medium text-foreground"></span>
                                </p>
                            </RzCalendarProvider>
                        </CardContent>
                    </RzCard>

                    <RzCard>
                        <CardHeader><CardTitle>Range Selection</CardTitle></CardHeader>
                        <CardContent class="flex flex-col items-center gap-4">
                            <RzCalendarProvider Mode="SelectionDatesMode.MultipleRanged" Range="_range1">
                                <div class="rounded-md border p-1">
                                    <RzCalendar Mode="SelectionDatesMode.MultipleRanged" />
                                </div>
                                <p class="text-sm text-muted-foreground">
                                    Range: <span x-text="startDate || 'Start'" class="font-medium text-foreground"></span>
                                    - <span x-text="endDate || 'End'" class="font-medium text-foreground"></span>
                                </p>
                            </RzCalendarProvider>
                        </CardContent>
                    </RzCard>
                </div>
            </section>

            <!-- 2. Presets & Controls -->
            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Presets & Controls" class="scroll-mt-20">Presets & Controls</RzHeading>
                <RzParagraph>
                    The provider exposes an API (`setToday`, `addDays`) that external buttons can call directly.
                </RzParagraph>

                <RzCard class="w-fit mx-auto">
                     <RzCalendarProvider Mode="SelectionDatesMode.Single" Value="_date1">
                         <div class="flex flex-col lg:flex-row">
                             <div class="flex flex-col gap-2 p-3 lg:border-r">
                                <RzButton Variant="ThemeVariant.Default" Outline Size="Size.Small" class="justify-start" x-on:click="setToday()">Today</RzButton>
                                <RzButton Variant="ThemeVariant.Default" Outline Size="Size.Small" class="justify-start" x-on:click="addDays(1)">Tomorrow</RzButton>
                                <RzButton Variant="ThemeVariant.Default" Outline Size="Size.Small" class="justify-start" x-on:click="addDays(3)">In 3 days</RzButton>
                                <RzButton Variant="ThemeVariant.Default" Outline Size="Size.Small" class="justify-start" x-on:click="addDays(7)">In a week</RzButton>
                             </div>
                             <div class="p-3">
                                 <RzCalendar class="border-0 shadow-none p-0" />
                             </div>
                         </div>
                    </RzCalendarProvider>
                </RzCard>
            </section>

            <!-- 3. Popovers & Inputs -->
            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Popovers & Inputs" class="scroll-mt-20">Popovers & Inputs</RzHeading>
                <RzParagraph>
                    Combine <code>RzPopover</code> with <code>RzCalendarProvider</code> to create dropdown pickers. 
                    The input binding uses <code>x-model="date"</code> to sync typing and clicking automatically.
                </RzParagraph>

                <div class="flex flex-col gap-6 items-center">
                    
                    <!-- Popover Single -->
                    <div class="flex flex-col gap-2">
                        <Label>Date of birth</Label>
                        <RzCalendarProvider Mode="SelectionDatesMode.Single" Value="_date1">
                            <RzPopover>
                                <PopoverTrigger AsChild>
                                    <RzButton Variant="ThemeVariant.Default" Outline class="w-[240px] justify-start text-left font-normal">
                                        <Blazicon Svg="Lucide.Calendar" class="mr-2 size-4" />
                                        <span x-text="date || 'Pick a date'"></span>
                                    </RzButton>
                                </PopoverTrigger>
                                <PopoverContent class="w-auto p-0">
                                    <!-- Close popover on selection -->
                                    <div x-on:rz:calendar:click-day="open = false">
                                        <RzCalendar />
                                    </div>
                                </PopoverContent>
                            </RzPopover>
                        </RzCalendarProvider>
                    </div>

                    <!-- Popover Range -->
                    <div class="flex flex-col gap-2">
                        <Label>Select your stay</Label>
                        <RzCalendarProvider Mode="SelectionDatesMode.MultipleRanged" Range="_range1">
                            <RzPopover>
                                <PopoverTrigger AsChild>
                                    <RzButton Variant="ThemeVariant.Default" Outline class="w-[300px] justify-start text-left font-normal">
                                        <Blazicon Svg="Lucide.Calendar" class="mr-2 size-4" />
                                        <span x-text="isRangeComplete ? (startDate + ' - ' + endDate) : 'Pick a date range'"></span>
                                    </RzButton>
                                </PopoverTrigger>
                                <PopoverContent class="w-auto p-0">
                                    <!-- Close popover when range is complete -->
                                    <div x-on:rz:calendar:range-complete="open = false">
                                        <RzCalendar Mode="SelectionDatesMode.MultipleRanged" Type="CalendarType.Multiple" Options="@(new VanillaCalendarOptions { DisplayMonthsCount = 2 })" />
                                    </div>
                                </PopoverContent>
                            </RzPopover>
                        </RzCalendarProvider>
                    </div>

                    <!-- Input Integration -->
                    <div class="flex flex-col gap-2 w-[240px]">
                        <Label>Two-Way Input Binding</Label>
                        <RzCalendarProvider Mode="SelectionDatesMode.Single" Value="_date1">
                            <div class="relative">
                                <input type="text" 
                                       class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50" 
                                       placeholder="YYYY-MM-DD" 
                                       x-model="date" />
                                <div class="absolute right-0 top-0">
                                    <RzPopover Anchor="AnchorPoint.BottomEnd" Offset="8">
                                        <PopoverTrigger AsChild>
                                            <RzButton Variant="ThemeVariant.Ghost" Size="Size.Small" class="px-2 h-9">
                                                <Blazicon Svg="Lucide.Calendar" class="size-4 opacity-50" />
                                            </RzButton>
                                        </PopoverTrigger>
                                        <PopoverContent class="w-auto p-0">
                                            <div x-on:rz:calendar:click-day="open = false">
                                                <RzCalendar />
                                            </div>
                                        </PopoverContent>
                                    </RzPopover>
                                </div>
                            </div>
                        </RzCalendarProvider>
                    </div>
                </div>
            </section>

            <!-- 4. Interactive Event List (Client-Side) -->
            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Event List (Interactive)" class="scroll-mt-20">Event List (Interactive)</RzHeading>
                <RzParagraph>
                    This example shows how to use <code>RzCalendarProvider</code> to drive other UI elements. 
                    The list below reacts instantly to date selection using Alpine.js logic.
                </RzParagraph>

                <RzCard class="w-[350px] mx-auto">
                    <RzCalendarProvider Mode="SelectionDatesMode.Single" Value="_date1">
                        <CardContent class="p-0">
                             <RzCalendar class="border-0 shadow-none" />
                        </CardContent>
                        <CardFooter class="flex flex-col gap-2 items-start border-t p-4 min-h-[100px]">
                             <!-- Reactive Header -->
                             <div class="flex justify-between w-full items-center">
                                 <span class="font-medium text-sm" x-text="date ? new Date(date).toLocaleDateString(undefined, { weekday: 'long', month: 'long', day: 'numeric' }) : 'Select a date'"></span>
                                 <RzButton Variant="ThemeVariant.Ghost" Size="Size.ExtraSmall"><Blazicon Svg="Lucide.Plus" /></RzButton>
                             </div>
                             
                             <!-- Logic to show simulated events -->
                             <div class="space-y-2 w-full" x-show="date">
                                 <div class="rounded-md bg-muted px-3 py-2 text-sm">
                                     <div class="font-medium">Team Sync</div>
                                     <div class="text-xs text-muted-foreground">9:00 AM - 10:00 AM</div>
                                 </div>
                                 <div class="rounded-md bg-muted px-3 py-2 text-sm">
                                     <div class="font-medium">Design Review</div>
                                     <div class="text-xs text-muted-foreground">1:00 PM - 2:30 PM</div>
                                 </div>
                             </div>
                             
                             <div x-show="!date" class="text-xs text-muted-foreground w-full text-center py-2">
                                 Pick a date to see your schedule.
                             </div>
                        </CardFooter>
                    </RzCalendarProvider>
                </RzCard>
            </section>
            
            <!-- 5. Mobile Drawer -->
            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Drawer (Mobile)" class="scroll-mt-20">Drawer (Mobile)</RzHeading>
                <RzParagraph>
                    Uses <code>RzSheet</code> with <code>RzCalendarProvider</code> to handle selection and closing.
                </RzParagraph>

                <div class="flex justify-center">
                    <RzCalendarProvider Mode="SelectionDatesMode.Single" Value="_date1">
                        <RzSheet>
                            <SheetTrigger AsChild>
                                <RzButton Variant="ThemeVariant.Default" Outline>
                                    <Blazicon Svg="Lucide.Calendar" class="mr-2 size-4" />
                                    <span x-text="date || 'Open Calendar'"></span>
                                </RzButton>
                            </SheetTrigger>
                            <SheetContent Side="SheetSide.Bottom" class="h-auto">
                                <SheetHeader>
                                    <SheetTitle>Select Date</SheetTitle>
                                    <SheetDescription>Select a date for your appointment.</SheetDescription>
                                </SheetHeader>
                                <div class="mx-auto mt-4" x-on:rz:calendar:click-day="close">
                                    <RzCalendar class="border-0 shadow-none" />
                                </div>
                                <SheetFooter>
                                    <SheetClose AsChild><RzButton class="w-full">Cancel</RzButton></SheetClose>
                                </SheetFooter>
                            </SheetContent>
                        </RzSheet>
                    </RzCalendarProvider>
                </div>
            </section>

        </MainContent>
    </RzArticle>
</RzQuickReferenceContainer>

@code {
    private DateOnly? _date1 = DateOnly.FromDateTime(DateTime.Now);
    private CalendarDateRange? _range1 = new() { From = DateTime.Now, To = DateTime.Now.AddDays(7) };

    private VanillaCalendarOptions _priceOptions = new()
    {
        Popups = new Dictionary<DateOnly, Popup>
        {
            [DateOnly.FromDateTime(DateTime.Now.AddDays(1))] = new Popup { Html = "<div class='text-[10px] text-muted-foreground mt-6'>$150</div>" },
            [DateOnly.FromDateTime(DateTime.Now.AddDays(2))] = new Popup { Html = "<div class='text-[10px] text-muted-foreground mt-6'>$200</div>" },
            [DateOnly.FromDateTime(DateTime.Now.AddDays(3))] = new Popup { Html = "<div class='text-[10px] text-muted-foreground mt-6'>$180</div>" },
        }
    };
}