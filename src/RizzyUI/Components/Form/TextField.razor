@namespace RizzyUI
@using System.Linq.Expressions
@using Rizzy.Components
@using System.ComponentModel
@inherits RizzyComponent

<Field class="@RootClass()">
    <FieldLabel DisplayName="@DisplayName" For="@For">
        @if (Required)
        {
            <span class="text-sm text-red-600 dark:text-red-400">*</span>
        }
    </FieldLabel>
    <TextEdit For="@For" Role="@Role" Placeholder="@Placeholder" @attributes="AdditionalAttributes" />
    @if (FieldHelp != null)
    {
        <FieldHelp>@FieldHelp</FieldHelp>
    }
    <RzValidationMessage For="@For" />
</Field>

@code {
    [CascadingParameter]
    public EditContext? EditContext { get; set; }

    [CascadingParameter]
    private RzEditForm? EditForm { get; set; }

    [Parameter]
    public TextRole Role { get; set; } = TextRole.Text;

    [Parameter]
    public string Placeholder { get; set; } = string.Empty;

    [Parameter]
    public string? DisplayName { get; set; }

    [Parameter]
    public bool Required { get; set; } = false;

    [Parameter]
    public RenderFragment? FieldHelp { get; set; }

    /// <summary>
    /// Specifies the field for which validation messages should be displayed.
    /// </summary>
    [Parameter, EditorRequired] 
    public Expression<Func<string>>? For { get; set; }

    protected override void OnParametersSet()
    {
        if (EditForm is null)
		    throw new InvalidEnumArgumentException("This field must be part of an RzEditForm");

	    base.OnParametersSet();
    }

}
